---
title: "ë„¤ì´ë²„ ì£¼ì‹ í˜„ì¬ê°€ ì •ë³´ ìˆ˜ì§‘"
date: 2023-11-20
# weight: 1
# aliases: ["/í¬ë¡¤ë§"]
tags: ["Crawler", "Automation", "Coding"]
author: "CrackerNote"
showToc: true
TocOpen: false
draft: false
hidemeta: false
comments: true
disableHLJS: false # to disable highlightjs
disableShare: true
hideSummary: false
searchHidden: true
ShowReadingTime: false
ShowBreadCrumbs: true
ShowPostNavLinks: true
ShowWordCount: false
ShowRssButtonInSectionTermList: true
UseHugoToc: false
searchHidden: true
typora-root-url: ../
---

## 1ï¸âƒ£ ë„¤ì´ë²„ ì£¼ì‹ í˜„ì¬ê°€ ì •ë³´ ìˆ˜ì§‘

ë„¤ì´ë²„ ì¦ê¶Œ ì‚¬ì´íŠ¸ í˜„ì¬ê°€ ë°ì´í„°ë¥¼ íŒŒì´ì¬ìœ¼ë¡œ ìˆ˜ì§‘

### ğŸ“œë„¤ì´ë²„ ì£¼ì‹ í˜„ì¬ê°€ í¬ë¡¤ë§

- í¬ë¡¤ë§ í•´ì˜¬ ì •ë³´ì˜ id ê°’ê³¼ URLì˜ íŒŒë¼ë¯¸í„°ë¥¼ í™•ì¸ í•„ìš”
  
  - id="_nowVal" / ?code=086960 (URL ìƒì˜ ì¢…ëª© ì½”ë“œ í™•ì¸)
  
  ```python
  import requests
  from bs4 import BeautifulSoup
  
  #ì¢…ëª© ì½”ë“œ ë¦¬ìŠ¤íŠ¸
  codes = [
      '005930',
      '000660',
      '035720'
  ]
  
  for code in codes:
      url = f"https://finance.naver.com/item/sise.naver?code={code}"
      reponse = requests.get(url)
      html = reponse.text
      soup = BeautifulSoup(html, "html.parser")
      price = soup.select_one("#_nowVal").text
      price = price.replace(',','')
      print(price)
  ```
  
  

### ğŸ“œì—‘ì…€ì„ ë¶ˆëŸ¬ì™€ì„œ ë°ì´í„° ì €ì¥í•˜ê¸°

- openpyxl ì‚¬ìš©

  ```python
  import requests
  from bs4 import BeautifulSoup
  import openpyxl
  
  fpath = r'C:\Users\hjopy\OneDrive\ë°”íƒ• í™”ë©´\crawler\ë„¤ì´ë²„ì£¼ì‹ í˜„ì¬ê°€ í¬ë¡¤ë§\data.xlsx'
  wb = openpyxl.load_workbook(fpath)
  ws = wb.active
  
  
  #ì¢…ëª© ì½”ë“œ ë¦¬ìŠ¤íŠ¸
  codes = [
      '005930',
      '000660',
      '035720'
  ]
  
  row = 2
  for code in codes:
      url = f"https://finance.naver.com/item/sise.naver?code={code}"
      reponse = requests.get(url)
      html = reponse.text
      soup = BeautifulSoup(html, "html.parser")
      price = soup.select_one("#_nowVal").text
      price = price.replace(',','')
      print(price)
      ws[f'B{row}'] = int(price)
      row = row + 1
  
  wb.save(fpath)
  ```
